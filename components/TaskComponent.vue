<!-- Please remove this file from your project -->
<template>
  <div class="content" id="content">
    <div @mouseup="mouseup">
      <p> orem ipsum dolor sit amet, consectetur adipiscing elit. Nunc rhoncus velit mi, at scelerisque nibh mattis a.
        Etiam nec nunc in dui mollis pharetra et quis neque. Phasellus iaculis accumsan metus congue cursus. Cras
        interdum, tellus vitae dignissim rutrum, nisi metus blandit ipsum, pretium auctor libero odio condimentum nulla.
        Quisque consequat sed diam laoreet tempor. Sed vel ante mattis, semper neque non, pellentesque nisi. Phasellus a
        tellus volutpat, sodales urna non, imperdiet velit. Suspendisse potenti. In vitae justo aliquam, semper ante eu,
        convallis ipsum. Ut rhoncus eget dolor vitae auctor.
      </p>
      <p> Curabitur commodo efficitur lorem et placerat. Pellentesque in tristique orci. Cras non suscipit neque. Morbi
        in ipsum laoreet, consectetur sapien ut, iaculis urna. In in purus id sem sagittis convallis. Vestibulum
        dignissim diam eget mollis lobortis. Donec malesuada molestie quam, eget aliquet ex tempus vel. Nulla fermentum
        est et magna tempus, non posuere sem feugiat. Mauris tincidunt nibh sed tincidunt fringilla. Donec eget massa
        vestibulum, viverra lectus eget, accumsan urna. Nam hendrerit odio at nunc lacinia, a mollis sem gravida.
        Interdum et malesuada fames ac ante ipsum primis in faucibus.</p>

      <p> Mauris accumsan, mauris maximus imperdiet iaculis, urna lectus pellentesque elit, quis convallis est purus
        vitae nulla. Curabitur tincidunt eget velit ut semper. Etiam mattis ligula quam. Morbi auctor, velit sed
        placerat dapibus, tortor dui pretium odio, quis vestibulum neque orci vitae justo. Vivamus in pulvinar dui.
        Phasellus est urna, posuere in sapien in, tempor rhoncus neque. Curabitur nisl augue, efficitur non libero
        consequat, aliquam gravida mauris. Suspendisse consequat nisl ipsum, et congue diam iaculis vitae.</p>

      <p> Vivamus ut mollis ante. Suspendisse vitae euismod ligula. Donec vitae arcu ullamcorper, dignissim odio a,
        mollis nulla. Sed blandit dui quam, vel cursus felis porttitor in. Nam laoreet, sapien eget ultricies ultrices,
        ipsum eros faucibus urna, ac venenatis nibh metus sit amet ipsum. Nulla vestibulum volutpat leo sit amet
        porttitor. Integer efficitur odio lectus, ut rhoncus ligula congue a. In sollicitudin pulvinar semper.</p>

      <p> Etiam commodo quis lacus nec consequat. Suspendisse massa est, volutpat quis lacinia at, convallis in massa.
        Morbi varius tempus urna, nec posuere ligula scelerisque sit amet. Pellentesque cursus pharetra viverra.
        Pellentesque eu diam finibus, vulputate mauris vel, commodo sem. Suspendisse lobortis, ex eu consequat
        elementum, ex neque iaculis tortor, sed consequat risus neque a orci. Morbi tempor ligula posuere nulla
        elementum fermentum eget vitae nisi. Aliquam non ligula pellentesque erat blandit blandit. Integer sit amet
        aliquet odio. Phasellus nec nunc a lacus hendrerit aliquam. Interdum et malesuada fames ac ante ipsum primis in
        faucibus. Vivamus magna mi, egestas at velit in, tempus hendrerit eros. Phasellus pharetra ex nec elit aliquam
        commodo. In ut lectus sed dui finibus egestas eget a massa. Etiam quis felis facilisis, tincidunt lorem id,
        fringilla elit.</p>

      <p> Quisque ultrices tortor sed orci rhoncus condimentum. Duis in pharetra leo. Nullam in aliquet urna, in
        placerat sem. Suspendisse potenti. Suspendisse sit amet diam sollicitudin, euismod odio at, scelerisque arcu.
        Integer dictum vel leo non eleifend. Ut semper, purus commodo ultrices tincidunt, sapien ante porttitor velit, a
        consectetur nisi lorem et lorem.</p>

      <p> Phasellus id sapien arcu. Maecenas at tellus cursus, pulvinar libero at, hendrerit mi. Curabitur sed iaculis
        elit. Donec sit amet accumsan purus. Mauris ullamcorper nec justo ut vestibulum. Integer quis nisl nec velit
        condimentum commodo at ac urna. Vivamus euismod posuere dignissim.</p>

      <p> Morbi eleifend risus eget augue consectetur, molestie volutpat nulla consectetur. Aliquam vestibulum consequat
        odio, ut eleifend nisl elementum ac. Orci varius natoque penatibus et magnis dis parturient montes, nascetur
        ridiculus mus. Sed ut neque vel augue consectetur faucibus. Morbi pretium vel lectus quis rhoncus. Sed sed nulla
        condimentum, euismod quam sit amet, ullamcorper tellus. Donec pretium metus felis, porta blandit lectus accumsan
        et. Donec malesuada risus nunc, in fermentum nibh tincidunt id.</p>

      <p> Sed scelerisque lacus quam, non rutrum justo faucibus ut. Suspendisse nec odio vitae quam laoreet congue.
        Donec vestibulum libero eu ante condimentum pulvinar. Proin vehicula laoreet fringilla. Proin luctus mattis
        lorem vitae posuere. Proin feugiat vel turpis quis facilisis. Etiam mattis mollis felis ut volutpat. Quisque
        maximus risus sed ipsum dignissim porta. Donec ipsum nibh, hendrerit ac orci a, rhoncus commodo ante. Sed nec
        tincidunt ipsum. Duis ut nisl congue, luctus sem sed, pharetra libero. Praesent at mauris mi. Pellentesque
        habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Suspendisse potenti. Sed
        interdum ligula id nulla fermentum efficitur. Duis ultrices semper ipsum eu semper.</p>

      <p> Sed volutpat, mi in scelerisque ultricies, enim sem vehicula purus, eu porttitor est augue vitae eros. Vivamus
        eu lacus at tellus suscipit porttitor eget non nunc. Maecenas eleifend libero felis, at maximus lorem congue sit
        amet. Etiam efficitur turpis purus, id lacinia velit feugiat id. Integer mi urna, fermentum sit amet aliquam in,
        rutrum non nulla. Nulla tincidunt pharetra risus, sed eleifend risus lacinia sed. Phasellus nec auctor lacus.
        Duis eget purus at sapien rutrum eleifend. Donec ut sapien tellus. Interdum et malesuada fames ac ante ipsum
        primis in faucibus. Vivamus a porta nibh. Morbi maximus, est nec tempus finibus, odio lorem porta sem, quis
        dictum felis ipsum at magna. In vestibulum lacinia fringilla. Pellentesque habitant morbi tristique senectus et
        netus et malesuada fames ac turpis egestas. Nunc feugiat eleifend velit vitae molestie.</p>

      <p> Etiam sed urna ante. Duis consectetur, felis ac ullamcorper efficitur, tortor turpis vulputate eros, auctor
        aliquam dolor ligula eu quam. In sed dui in dui fringilla tincidunt vel rhoncus turpis. Aliquam erat volutpat.
        Integer tincidunt lectus sed dui mattis luctus. In eget auctor lorem. Vivamus quis erat massa. Vivamus laoreet
        urna non nisl hendrerit ultrices. Praesent maximus in erat non ultrices. Pellentesque consectetur quis risus vel
        cursus. Quisque vel urna eu nulla volutpat imperdiet eu at nunc. Vestibulum quis magna quis nulla pellentesque
        rutrum nec et nunc.</p>

      <p> Phasellus quis odio sed ligula efficitur condimentum in gravida enim. Nulla ultricies ipsum interdum sapien
        luctus tincidunt. Lorem ipsum dolor sit amet, consectetur adipiscing elit. In nec turpis lectus. In molestie
        ligula at turpis dictum, a semper est faucibus. Nunc a orci vitae enim imperdiet malesuada sit amet sed eros.
        Vestibulum dapibus diam egestas velit feugiat euismod. Nulla volutpat tristique magna eu sodales. In hac
        habitasse platea dictumst. Phasellus aliquam facilisis semper.</p>

      <p> Donec in est eleifend, placerat risus bibendum, egestas turpis. Quisque a tellus tempus, scelerisque orci sed,
        viverra diam. Quisque vitae facilisis neque. Pellentesque ac orci feugiat, ullamcorper lacus porta, aliquam mi.
        Aliquam neque ligula, fringilla sit amet purus vel, lobortis consectetur nibh. Proin id malesuada risus, eget
        volutpat nisl. Vivamus auctor, quam ut faucibus aliquet, tellus eros porttitor sapien, a fringilla lectus tortor
        eu libero. Donec eget orci diam. Mauris eget urna aliquet, condimentum purus eget, mattis nisi. Fusce blandit
        porta leo blandit ullamcorper.</p>

      <p> Nulla sit amet tristique ante. Praesent blandit ac enim vitae placerat. Suspendisse rhoncus in lectus rhoncus
        tristique. Donec auctor non mauris sed gravida. Vivamus at odio iaculis, suscipit leo vel, facilisis lorem.
        Pellentesque at nulla lacus. Proin fringilla non lacus quis auctor. Sed at velit ex.</p>

      <p> Maecenas tortor ex, ornare ac fringilla at, sollicitudin id purus. Integer elementum ultrices nisi, vitae
        vestibulum metus malesuada id. Quisque eu ultrices sem. Nulla maximus, magna quis dictum iaculis, mi magna
        fringilla sem, et cursus massa nisi non dui. Donec eleifend malesuada pulvinar. Sed ut ante odio. Ut imperdiet
        felis lorem, et tincidunt ex rutrum id. Praesent rhoncus non nibh sed lobortis. Nullam lobortis quis nisi id
        pretium. Nulla facilisis eu neque sed posuere. Nam ut mattis sapien. Integer finibus, enim eu pharetra mattis,
        ligula libero mattis eros, vitae interdum massa nunc vitae justo.</p>

      <p> Ut tristique dignissim augue at ultrices. Aliquam eu ligula eget diam vestibulum fringilla. Duis tortor magna,
        hendrerit nec laoreet vitae, eleifend non lorem. Sed imperdiet pulvinar maximus. Quisque nec pellentesque
        sapien. Cras eget euismod nunc. Nullam eu viverra mauris. Ut pellentesque ornare tempor. Quisque at lorem a
        tortor suscipit eleifend. Quisque lacinia ornare augue, quis iaculis nulla pretium ut. Sed quis rhoncus diam, at
        cursus diam.</p>

      <p> Aenean nunc turpis, dapibus eu est nec, cursus vehicula elit. Proin ut nulla ut velit rhoncus facilisis
        posuere eu lectus. Duis egestas tortor vel sem maximus viverra non a erat. Vestibulum ante ipsum primis in
        faucibus orci luctus et ultrices posuere cubilia curae; Phasellus egestas arcu et gravida aliquam. Aenean luctus
        enim nec molestie sagittis. Curabitur et tincidunt urna. Vestibulum et tempus lorem, in pretium quam. Ut ut
        risus magna.</p>

      <p> Curabitur eu commodo lectus. Donec tempus eros eu neque consequat ullamcorper. In ultrices neque a mauris
        fermentum condimentum. Maecenas eu leo quis dolor tempus accumsan. Aliquam dapibus tellus ut porttitor
        ullamcorper. Maecenas vulputate ipsum pharetra, ultrices purus non, iaculis dui. Curabitur id nibh quis mi
        semper euismod. Praesent tellus enim, pellentesque non turpis ac, luctus sollicitudin magna. Nulla facilisi. Ut
        volutpat nec dui sit amet dignissim. Nulla vulputate id libero eu dignissim. Nulla massa leo, congue nec congue
        in, egestas elementum sem. Integer lobortis eget nisl eget feugiat.</p>

      <p> Vestibulum in posuere est. Pellentesque lacinia justo sed porta vestibulum. In hac habitasse platea dictumst.
        Aliquam ut ultrices odio. Quisque finibus varius gravida. Nullam ac ante a sem dapibus bibendum non eget lorem.
        Nunc vestibulum nec metus vitae luctus. Ut ultrices id elit id bibendum. Pellentesque sed purus libero. Duis
        tincidunt nisl ac neque bibendum, vitae porta nibh facilisis. Suspendisse in enim erat. Donec iaculis odio at
        augue egestas lacinia.</p>

      <p> Donec nunc augue, vehicula quis nibh et, vestibulum lacinia diam. Curabitur laoreet vulputate leo in ultrices.
        Donec suscipit convallis lacus, vitae egestas nulla cursus ac. Cras euismod urna volutpat suscipit convallis.
        Donec feugiat magna sit amet gravida convallis. Sed interdum maximus risus a rhoncus. Aliquam aliquam velit nec
        accumsan aliquam. Cras hendrerit eros et massa dignissim, ac consequat orci finibus. Nulla facilisi. Maecenas
        imperdiet eleifend neque, sagittis dictum arcu euismod vitae. Maecenas accumsan vulputate ipsum, at aliquet
        mauris semper et. Etiam vel ullamcorper sapien. Cras dapibus non nisl eget convallis.</p>
    </div>

    <div id="popup" class="popup" :class="{'open-popup':showPopup}" @click="shareLink">
      <span class="pointer">
        <img src="https://cdn-icons-png.flaticon.com/512/1017/1017466.png" alt="image">
      </span>
    </div>
  </div>
</template>

<script>
export default {
  name: 'TaskComponent',
  data() {
    return {
      showPopup: false,
      markedText: null
    }
  },
  mounted() {
    const scrollText = this.$route.query.id

    if (scrollText){
      const getParagraphs = document.getElementsByTagName('p');
      const listOfParagraphs = [...getParagraphs]

      listOfParagraphs.forEach((item)=>{
        if (item.textContent.includes(scrollText)){
          return item.scrollIntoView({behavior: "smooth", block: "start", inline: "nearest"});
        }
      })
    }
  },
  methods: {
    mouseup(e) {
      if (this.markedText) {
        this.markedText = ''
        this.showPopup = false
      }

      this.markedText = window.getSelection().toString();
      if (this.markedText) {
        this.showPopup = true

        const popup = document.getElementById('popup')
        const top = e.layerY - 40 + 'px'
        const left = e.layerX - 65 + 'px'
        popup.style.top = top;
        popup.style.left = left;
      }
    },
    async shareLink() {
      try {
        const response = await this.$axios.post('/api/save', {"text": this.markedText})
        const replaceLink = response.data.link.replaceAll(' ', '%20')
        const link = `${window.location.origin}${replaceLink}`

        this.showPopup = false
        this.markedText = null
        alert(link)
      } catch (err) {
        console.log(err)
      }
    }

  }
}
</script>


<style scoped>
.content {
  width: 70%;
  margin: 0 auto;
  position: relative;
}

.popup {
  background: #292929;
  display: inline-flex;
  align-items: center;
  border-radius: 5px;
  padding: 6px 10px;
  min-width: 100px;
  visibility: hidden;
  transition: all 0.5ms ease-in-out;
  position: absolute;
}
.popup:after{
  content: '';
  display: block;
  position: absolute;
  left: 60px;
  bottom: -10px;
  width: 0;
  height: 0;
  border-bottom: 5px solid transparent;
  border-top: 5px solid #292929;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
}
.popup img{
  width: 16px;
  height: 16px;
  display: flex;
}

.open-popup {
  visibility: visible;
}

.pointer {
  cursor: pointer;
}
</style>
